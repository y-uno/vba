Sub CreateComboBoxAndForm()
    ' 新しいユーザーフォームを作成
    Dim frm As Object
    Set frm = ThisWorkbook.VBProject.VBComponents.Add(3)
    frm.Name = "UserForm1"
    
    ' コンボボックスをユーザーフォームに追加
    With frm.Designer.Controls.Add("Forms.ComboBox.1", , True)
        .Name = "ComboBox1"
        .Left = 10
        .Top = 10
        .Width = 100
        .Height = 20
    End With
    
    ' OKボタンをユーザーフォームに追加
    With frm.Designer.Controls.Add("Forms.CommandButton.1", , True)
        .Name = "CommandButton1"
        .Caption = "OK"
        .Left = 10
        .Top = 40
    End With
    
    ' ユーザーフォームを表示
    UserForm1.Show
End Sub

Private Sub CommandButton1_Click()
    Dim selectedName As String
    
    ' コンボボックスで選択された名前を取得
    selectedName = ComboBox1.Value
    
    ' 選択された名前と"Hello"をメッセージボックスに表示
    MsgBox selectedName & " Hello"
    
    ' ユーザーフォームを非表示
    UserForm1.Hide
End Sub
